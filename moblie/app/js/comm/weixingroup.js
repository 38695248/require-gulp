define(["jquery","config"],function(e,t){var n=e("#bodywidth").width(),r=n*.8,i=function(n){if(n.catid_area){var r="";n.catid_type==1?r+="明星,":n.catid_type==2?r+="街拍达人,":r+="模特,",e("#user_group_area").find(".li_click").each(function(t,i){if(t+1==n.catid_area){var s=e(this).text();r+=s}}),n.catid_sex==1?r+=",男":r+=",女",e("#select_cat_text").html(r)}e("#group_cat").unbind("click").bind("click",function(n){function r(){var t=!1,n=!1,r=!1;e("#catlist_type").find("li").each(function(n,r){var i=e(this).hasClass("current");i&&(t=!0)}),e("#catlist_sex").find("li").each(function(t,r){var i=e(this).hasClass("current");i&&(n=!0)}),e("#catlist_area").find("li").each(function(t,n){var i=e(this).hasClass("current");if(i){var s=e(this).attr("value");r=!0}}),t&&r&&n?(e("#sns_grouptype").find(".btn-danger").addClass("btnTipsubmit").removeClass("btn-danger-gray"),e("#sns_grouptype").find(".btnTipsubmit").unbind("click").bind("click",function(){i()})):e("#sns_grouptype").find(".btn-danger").removeClass("btnTipsubmit").addClass("btn-danger-gray")}function i(){var n="";e("#catlist_type").find("li").each(function(t,r){var i=e(this).hasClass("current");if(i){var s=e(this).attr("value");n+=e(this).text()+",",e("#select_cat_type").val(s)}}),e("#catlist_area").find("li").each(function(t,r){var i=e(this).hasClass("current");if(i){var s=e(this).attr("value");n+=e(this).text()+",",e("#select_cat_area").val(s)}}),e("#catlist_sex").find("li").each(function(t,r){var i=e(this).hasClass("current");if(i){var s=e(this).attr("value");n+=e(this).text(),e("#select_cat_sex").val(s)}}),e("#select_cat_text").text(n),t.closeTip(e("#sns_grouptype"))}AjaxFunUtils.ajaxInit({url:"/common/gettpl.html?name=sns_grouptype&ch=sns",isloading:!0,yzlogin:!0,type:"GET",dataType:"html",params:{},callback:function(n){e("body").append(n);var i=e("#user_group_area").html();e("#catlist_area").html(i),t.tip.centerDiv({divId:"sns_grouptype",type:1,callback:function(){var t=e("#select_cat_type").val(),n=e("#select_cat_area").val(),i=e("#select_cat_sex").val();r(),e("#catlist_type").find(".li_click").each(function(n,i){var s=e(this).attr("value");s==t&&(e(this).addClass("current"),r())}),e("#catlist_area").find(".li_click").each(function(t,i){var s=e(this).attr("value");s==n&&(e(this).addClass("current"),r())}),e("#catlist_sex").find(".li_click").each(function(t,n){var s=e(this).attr("value");s==i&&(e(this).addClass("current"),r())}),e(".catlist").find(".li_click").unbind("click").bind("click",function(){e(this).addClass("current"),e(this).siblings(".li_click").removeClass("current"),r()})}})}})})},s=function(){AjaxFunUtils.ajaxInit({url:"/user_group/add_pin_groups.html	",params:{ajax:1},callback:function(t){if(t.status==1){if(!t.data)return e("#groupList").hide(),!1;var n='<input name="gpid" id="gpid" value="" type="hidden">';e.each(t.data,function(e,t){var r='<li style="padding-right:20px" class="rowbox li_radio_p"><span class="ico groupavatar"><img src="'+t.avatar[2]+'" data-original="'+t.avatar[1]+'" class="lazy_groupavatar"></span><div class="row-flex1 line40"><label for="'+t.gpid+'" class="row-flex1 label li_radio" style="line-height:60px;background-position: right 18px;" data-gpid="'+t.gpid+'">'+t.gpname+"</label></div></li>";n+=r}),e("#group_cat_share").find(".group_categoryList").html(n),e("img.lazy_groupavatar").checkImgExists(),e(".li_radio").unbind("click").bind("click",function(){var t=e(this).hasClass("current"),n=e(this).attr("data-gpid");t?(e(this).removeClass("current"),e("#gpid").val("")):(e("#gpid").val(n),e(this).addClass("current"),e(this).parents(".li_radio_p").siblings(".li_radio_p").find(".li_radio").removeClass("current"))})}e("#group_cat_share").selectUtils({deNum:0,isDef:!0,callback:function(t,n){var r=e("#group_cat").find("input");checkInputFun.initContext(r,checkInputFun.myIt),r.siblings("p").show(),checkInputFun.mycheckIn(r),e("#group_cat").siblings(".select_box").find("span").html("选择分类").removeClass("active"),e("#group_cat").siblings(".select_box").find(".select_analog ").val("")}})}})},o=function(n){var r={gpid:"",pic_avatar:"",pic_qrcode:"",pic_figure:"",btn:"",avatartype:"",auto_start:!1,callback:null};n&&e.extend(!0,r,n),t.loginCheck(),r.btn.unbind("click").bind("click",function(){var t=e(this),i=e(this).attr("data-name"),s=e(this).attr("data-avatar"),o=t.attr("data-type"),u=t.attr("data-act"),a=r.pic_avatar,f=t.attr("data-title"),l=t.siblings(".uppro_pic_list"),c=!1,h=1;o==3&&(c=!0,h=3),o=="qrcode"&&(a=r.pic_qrcode),o=="figure"&&(a=r.pic_figure),s&&(a=s),UploadUtils.uploadInit({tip:!0,uptitle:f,container:"allcontainer",browse_button:"allpickfiles",drop_element:"allcontainer",bucket:"avatar",iscover:!0,auto_start:r.auto_start,multi_selection:!1,picname:a,typebucket:2,callback:function(e,i){AjaxFunUtils.ajaxInit({url:"/common/avatar_up_cmm_back.html",params:{act:u,type:o,gpid:r.gpid,ch:"up",cutsize:""},callback:function(s){var o={arrData:e,odomain:i,resin:s,btn:t};n.callback&&r.callback(o)}})}})})},u=function(){e(".creatGroupBtn").unbind("click").bind("click",function(n){var r=t.loginCheck();if(!r)return!1;n.stopPropagation(),AjaxFunUtils.ajaxInit({url:"/user_group/add.html",type:"post",yzlogin:!0,params:{ajax:1},callback:function(n){if(n.status==1){var r=e('<div id="creatGroupTipbox" class="tipbox fade" data-index="0" style="display:none;"><div class="tipbox-in"><h1 class="tiptop">绑定微信群</h1><span class="ico02 tipclose closeBtnHtml"></span><div class="tipcont" id="creatGroupCont"></div>');e("body").append(r),e("#creatGroupCont").html(e(n.data).find(".contentbox").html()),t.tip.centerDiv({divId:"creatGroupTipbox",callback:function(){a({type:"share"})}})}else t.tip.tips({htmlmsg:'<div style="padding:30px">'+n.msg+"</div>",type:0})}})})},a=function(n){function s(){var t=!1;return e(".uppro_pic").each(function(n,r){return e(this).checkboxFn({checkbox:"hidden",scallback:function(e){e.removeClass("error_validate"),t=!0},errorcallback:function(e){e.addClass("error_validate"),t=!1}}),t}),t}function u(t){function r(t){var r=e(".up_rzpic");t&&(r=t),o({gpid:n.gpid,pic_avatar:n.pic_avatar,pic_qrcode:n.pic_qrcode,pic_figure:n.pic_figure,btn:r,callback:function(e){var t='<li class="li_del"><input type="hidden" class="hideimageurl" name="'+e.inputName+'" value="/'+e.arrData.key+'"><img src="'+e.resin.data+'" /><div class="operate"><i class="ico del"></i></div></li>';e.imgbox.find("ul").append(t),i(e.imgbox,e.btn,e.type),a(e.imgbox,e.btn,e.type),u(e.imgbox,e.btn,e.type)}})}function i(t,n,r){t.show(),t.find("li").hover(function(){e(this).find(".operate").show()},function(){e(this).find(".operate").hide()})}function u(t,n,r){t.find(".del").unbind("click").bind("click",function(){e(this).parents("li.li_del").remove();var i=t.find("li").size();i<=0&&t.hide(),a(t,n,r)})}function a(e,t,n){s(e,t,n);var i=e.find("li").size(),o=1;n==3&&(o=3);var u=!0;return i>=o?(t.addClass("btn-danger-gray"),t.unbind("click"),u=!1,u):(t.removeClass("btn-danger-gray"),r(t),o-=i,u)}var n={picname:""};t&&e.extend(!0,n,t),r()}var r={type:""};n&&e.extend(!0,r,n),i({}),e("#creatGroupForm").checkInput({submitBtnFn:function(n){var i=n.serializeJson(),s=e("#creatGroupForm").attr("data-action");AjaxFunUtils.ajaxInit({url:s,params:i,callback:function(n){n.status==1?(window.location.href="/user_group/home.html?gpid="+n.data.gpid+"&ukey="+ukey,e("#creatbtn_wc").unbind("click").bind("click",function(){r.type=="share"?t.closeTip(e("#creatGroupTipbox")):window.location.href="/user_group/my.html"})):t.tip.tips({htmlmsg:'<div style="padding:30px">'+n.msg+"</div>",w:"90%",type:0})}})}})};return{creatWeixinGroup_share:u,addgrouppage:a,getGroupList:s,selectCat:i,upGroupAvatar:o}});
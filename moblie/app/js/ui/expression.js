define(["jquery"],function(e){var t=e("#expression"),n=function(){var n={items:[{img:"s31.png",desc:"微笑"},{img:"s05.png",desc:"大笑"},{img:"s20.png",desc:"露齿"},{img:"s28.png",desc:"偷笑"},{img:"s57.png",desc:"可爱"},{img:"s30.png",desc:"吐舌"},{img:"n10.png",desc:"嘚瑟"},{img:"s78.png",desc:"难过"},{img:"s04.png",desc:"大哭"},{img:"s61.png",desc:"流泪"},{img:"s02.png",desc:"安慰"},{img:"s17.png",desc:"可怜"},{img:"s32.png",desc:"委屈"},{img:"n07.png",desc:"失望"},{img:"n09.png",desc:"拜托"},{img:"s15.png",desc:"奸笑"},{img:"s18.png",desc:"酷"},{img:"s11.png",desc:"害羞"},{img:"s23.png",desc:"色"},{img:"s22.png",desc:"亲吻"},{img:"s07.png",desc:"飞吻"},{img:"s35.png",desc:"阴险"},{img:"s34.png",desc:"疑问"},{img:"s65.png",desc:"撇嘴"},{img:"s80.png",desc:"左哼哼"},{img:"s81.png",desc:"右哼哼"},{img:"s41.png",desc:"傲慢"},{img:"s89.png",desc:"白眼"},{img:"s73.png",desc:"抠鼻"},{img:"s27.png",desc:"叹气"},{img:"s14.png",desc:"哼"},{img:"s03.png",desc:"鄙视"},{img:"s25.png",desc:"衰"},{img:"s12.png",desc:"汗"},{img:"s13.png",desc:"黑线"},{img:"n06.png",desc:"懒得理你"},{img:"s37.png",desc:"晕"},{img:"s90.png",desc:"狂汗"},{img:"s88.png",desc:"石化"},{img:"s79.png",desc:"无奈"},{img:"s16.png",desc:"惊讶"},{img:"s72.png",desc:"震惊"},{img:"s55.png",desc:"惊恐"},{img:"s10.png",desc:"鬼脸"},{img:"s52.png",desc:"高兴"},{img:"n04.png",desc:"太高兴了"},{img:"s46.png",desc:"发呆"},{img:"s51.png",desc:"尴尬"},{img:"s42.png",desc:"闭嘴"},{img:"s92.png",desc:"嘘"},{img:"n03.png",desc:"思考"},{img:"s49.png",desc:"奋斗"},{img:"n08.png",desc:"敬礼"},{img:"s48.png",desc:"钱"},{img:"s43.png",desc:"大兵"},{img:"s09.png",desc:"鼓掌"},{img:"s82.png",desc:"加油"},{img:"s36.png",desc:"拥抱"},{img:"s50.png",desc:"疯狂"}],lineSize:12,path:static_url+"/moblie/images/kefu/imgface/",getImgPath:function(t){var r;return!isNaN(1*t)&&t<n.items.length?r=n.path+n.items[t].img:e.each(n.items,function(e,i){return i.desc==t?(r=n.path+i.img,!1):void 0}),r},getImgNum:function(t){var r;return!isNaN(1*t)&&t<n.items.length?r=n.path+n.items[t].img:e.each(n.items,function(e,n){return n.desc==t?(r=n.img,!1):void 0}),r}},r=function(){var e=1,r=n.items.length,i=r+21-r%20,s=0,o="";o='<div class="expression-wrapper swiper-slide">';for(s;i>s;s++){if(s>=r&&(s+e)%7==0){o+='<span class="js-exp-del"><button class="btn btn-exp-del"></button></span></div>';break}(s+e)%21||(e++,o+='<span class="js-exp-del"><button class="btn btn-exp-del"></button></span></div>',i>s+2&&(o+='<div class="expression-wrapper swiper-slide">')),o+=r>s?'<span class="js-exp" exp="'+s+'" ><i style="background-image:url('+n.getImgPath(s)+')"></i></span>':"<span></span>"}o+="</div>",t.find("#swiper-wrapper").html(o)},i=!0,s=function(){if(t.is(":visible"))var e=new Swiper(t,{autoplay:!1,pagination:".swiper-pagination-kf",loop:0,loopAdditionalSlides:1,onInit:function(e){}})},o=function(){s();var n=null;e(window).on("resize",function(){return t.is(":visible")?(clearTimeout(n),void (n=setTimeout(function(){s()},150))):void (i=!0)})},u=function(){t.on("click",".js-exp",function(){var t="["+n.items[e(this).attr("exp")].desc+"]";require(["ui/textIn"],function(e){e.addInput(t,!0)})}),t.on("click",".js-exp-del",function(){require(["ui/textIn"],function(e){e.delInput(!0)})})};e.extend(e,{expression:{getImg:n.getImgPath}}),r(),o(),u();var a=function(){i&&s()},f=function(e){return e.replace(/\[([^\[\]]+)]/g,function(e,t){var r=n.getImgPath(t);return r?'<img class="expression-img" onload="this.style.backgroundImage=\'none\';" src="'+r+'">':e})},l=function(e){return e.replace(/\[([^\[\]]+)]/g,function(e,t){var r=n.getImgNum(t);return r?"[em]"+r+"[/em]":e})};return{getImgNum:l,getImgPath:n.getImgPath,rebuild:a,replace:f}};return n()});
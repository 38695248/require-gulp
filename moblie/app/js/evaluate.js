// copyright chris wanstrath

define("config",["jquery"],function($){var base={lang:{js_base_login_tip:"您还没有登录，请先登录！",js_base_login_btn:"登录",js_base_del_text:"你确定删除吗？",js_base_delbord_text:"你确定删除这个分类吗？",js_base_error:"系统异常，请稍后再试！",js_base_email:"Not a valid email.",js_base_password:"valid",js_base_mb:"请填写正确的手机号码",js_base_code:"",js_base_deltag:"您要删除当前标签吗？",js_base_money:"valid",js_base_prev:"上一页",js_base_next:"下一页",js_base_tip:"系统提示",js_base_cancel:"取消",js_base_del:"删除",js_base_confirm:"确认",js_base_des:"描述",js_base_qty:"数量",js_base_price:"价格",js_base_total:"总价",js_base_checkout:"去结算",js_base_cart:"购物车内暂时没有商品。",js_base_scoretomoney:"请正确输入享金。",js_base_myscore:"请正确输入金额。",js_base_emailyz:"马上去验证",js_reg_maxMsg:"最多只能选择10个",js_shareView_like:"赞TA",js_shareView_unlike:"已赞TA",js_shareView_follow:"关注",js_shareView_unfollow:"已关注",js_shareView_want:"想要",js_shareView_unwant:"不想要",js_upload_chooseimage:"选择图片",js_cart_canceluse:"取消使用",js_cart_theuse:"本次使用",js_cart_coupons:"优惠卷",js_cart_Integral:"享金",js_cart_pay:"支付",js_cart_folding:"折合",js_cart_currency:"人民币",js_cart_payType:"百享",js_Q_EXCEED_NUM_LIMIT:"超过最大上传数",js_myshare_inviteSuccess:"邀请成功！",js_myshare_mailSuccess:"邮件发送成功！",js_myshare_orderNo:"订单编号",js_myshare_Onlinepayment:"在线支付",js_myshare_view:"查看",js_myshare_reup:"重新上传",js_myshare_perform:"您确定执行该操作吗?",js_myshare_Myself:"我自己",js_index_copytext:"邀请链接地址已经复制到粘贴板，你可以使用Ctrl+V贴到需要的地方去了哦！",js_base_categorytext:"选择分类！",js_base_yourself:"自己不能给自己发信息。",Q_EXCEED_SIZE_LIMIT:"图片文件总大小超过系统限制大小。",F_EXCEED_SIZE:"图片大小超过系统限制大小5M，请重新选择。",Q_TYPE_DENIED:"图片格式不对，只能上传jgif,jpg,jpeg,png图片",error:"系统提示",uptimeout:"亲，您的网络太慢，上传超时！请重新上传！",maxCategoryNum:"最多只能选15个分类。",certification:"你还没有通过实名认证，请先认证。",js_upavatartitle:"请从您手机选择头像上传",js_upshareimg:"请从手机相册选择图片",js_upproimg:"请从手机相册选择图片",js_shippingtotal:"包邮",js_order_sizes:"尺码",js_order_color:"颜色",js_order_for:"私定人",js_order_type_t:"团",js_order_type_p:"私"},getHeightBody:function(){var e=0;return this.browser.versions.ios||this.browser.versions.iPhone||this.browser.versions.iPad?e=window.screen.availHeight:this.browser.versions.android?e=$(window).height():e=$(window).height(),e},getWidthBody:function(){var e=0;return this.browser.versions.ios||this.browser.versions.iPhone||this.browser.versions.iPad?e=window.screen.availWidth:this.browser.versions.android?e=$("body").width():e=$("body").width(),e},browser:{versions:function(){var e=navigator.userAgent,t=navigator.appVersion;return{trident:e.indexOf("Trident")>-1,presto:e.indexOf("Presto")>-1,webKit:e.indexOf("AppleWebKit")>-1,gecko:e.indexOf("Gecko")>-1&&e.indexOf("KHTML")==-1,ios:!!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:e.indexOf("Android")>-1||e.indexOf("Linux")>-1,iPhone:e.indexOf("iPhone")>-1||e.indexOf("Mac")>-1,iPad:e.indexOf("iPad")>-1,webApp:e.indexOf("Safari")==-1}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()},isNull:function(e){if(e=="")return!0;var t="^[ ]+$",n=new RegExp(t);return n.test(e)},getQueryString:function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),n=window.location.search.substr(1).match(t);return n!=null?unescape(n[2]):null},loadInit:function(e){var t=$('<div id="loadingMask" class="loadingMask" style="z-index:999999"></div>'),n={status:1};e&&$.extend(n,e),n.status==1?$("body").append(t):$("#loadingMask").remove()}},tip={tips:function(e){var t={htmlmsg:"",title:base.lang.js_base_tip,type:1,istop:!1,position:"fixed",isShade:!0,touchmove:0,callback:function(){},scallback:function(){},dcallback:function(){},closeback:function(){},w:"96%"};e&&$.extend(t,e);var n='<div class="tipbox-in" data-index="0"><h1 class="tiptop">'+t.title+"</h1>"+'<span class="ico02 tipclose closeBtn"></span>'+'<form class="tipForm">'+'<div class="tipcont">'+t.htmlmsg+"</div>"+'<div id="tipbottom" class="tipbottom">'+'<div class="fr formFooterButtons">'+'<button class="btn-border btn rounded mr-5 btnCancel closeBtn" type="button">'+'<span class="buttonText">'+base.lang.js_base_cancel+"</span>"+"</button>"+'<button type="button" class="btn btn-danger btnTipsubmit">'+'<span class="buttonText">'+base.lang.js_base_confirm+"</span>"+"</button>"+"</div>"+'<div class="blank0"></div>'+"</div></form>"+"</div>",r=$(".modalMask").size(),i=$('<div id="tipbox_'+r+'" data-index="'+r+'" class="tipbox fade" style="width:'+t.w+'">'+n+"</div>");t.type==0&&i.find(".btnCancel").remove(),$("body").append(i),e.callback&&t.callback();var s="tipbox_"+r;this.currentPosition({divId:s,num:r,shade:t.isShade,position:t.position,istop:t.istop,touchmove:t.touchmove}),i.find(".closeBtn").unbind("click").bind("click",function(){var n=$(this).parents(".tipbox").attr("data-index"),r=$(this).parents(".tipbox");tip.tipsClosed({myIndeTipDiv:r,numIndex:n}),e.closeback&&t.closeback()}),i.find(".btnTipsubmit").unbind("click").bind("click",function(){var n=$(this).parents(".tipbox").attr("data-index"),r=$(this).parents(".tipbox");e.scallback&&t.scallback(),tip.tipsClosed({myIndeTipDiv:r,numIndex:n}),e.dcallback&&t.dcallback()})},centerDiv:function(e){var t={divId:"",isShade:!0,w:"96%",type:0,istop:!1,isbottom:!1,position:"absolute",p_new:0,touchmove:0,callback:function(){},zcallback:function(){},closeback:function(){}};e&&$.extend(t,e);var n=$(".modalMask").size();$("#"+t.divId).attr("data-index",n),$("#"+t.divId).css({width:t.w}),e.callback&&t.callback({num:n}),this.currentPosition({divId:t.divId,num:n,shade:t.isShade,position:t.position,callback:t.zcallback,istop:t.istop,touchmove:t.touchmove,isbottom:t.isbottom}),$(".closeBtnHtml").unbind("click").bind("click",function(){var n=$(this).parents(".tipbox").attr("data-index"),r=$(this).parents(".tipbox");tip.centerDivClosed({indexTipDiv:r,indexNum:n,type:t.type});var i=$("#bigcategorybox").attr("data-index");tip.centerDivClosed({indexNum:i,indexTipDiv:$("#bigcategorybox"),type:1}),e.closeback&&t.closeback()})},currentPosition:function(e){var t=e.position;if(t=="absolute")var n=this.getPageOffset().x+($("body").width()-$("#"+e.divId).width())/2,r=this.getPageOffset().y+(base.getHeightBody()-$("#"+e.divId).height())/2;else var n=($("body").width()-$("#"+e.divId).width())/2,r=(base.getHeightBody()-$("#"+e.divId).height())/2;var i=$(".modalMask").size()*90+9999,s=e.num;e.shade&&this.addShade({num:s,touchmove:e.touchmove}),r<=0&&!e.istop?r=20:e.istop&&(r=0),n<=0&&!e.istop?n=20:e.istop&&(n=0),e.isbottom==1?$("#"+e.divId).css({"z-index":i+1}).show():$("#"+e.divId).css({left:n,top:r,position:t,"z-index":i+1}).addClass("show loaded").show(),e.callback&&e.callback()},tipsClosed:function(e){var t=e.numIndex,n=e.myIndeTipDiv;n.remove(),$("#modalMask_"+t).remove(),e.callback&&e.callback()},centerDivClosed:function(e){var t={indexNum:"",indexTipDiv:"",type:0,callback:function(){}};e&&$.extend(t,e),t.type==1?(t.indexTipDiv.remove(),$("#modalMask_"+t.indexNum).remove()):t.type==2?(t.indexTipDiv.hide(),$("#modalMask_"+t.indexNum).remove()):(t.indexTipDiv.hide(),$("#modalMask_"+t.indexNum).hide()),e.callback&&t.callback()},addShade:function(e){var t=e.num,n=e.num*90+9998,r=document.createElement("div");r.id="modalMask_"+t,r.className="modalMask",$("body").append(r),$("#modalMask_"+t).show().css({"z-index":n}),e.touchmove==1&&$("#modalMask_"+t).bind("touchmove",function(e){e.preventDefault()})},getPageOffset:function(){var e={};return window.innerWidth?(e.x=window.pageXOffset,e.y=window.pageYOffset):document.documentElement&&document.documentElement.clientWidth?(e.x=document.documentElement.scrollLeft,e.y=document.documentElement.scrollTop):document.body.clientWidth&&(e.x=document.body.scrollLeft,e.y=document.body.scrollTop),e}},loginCheck=function(e){var t=!0;return islogin==0&&(e!=1&&tip.tips({htmlmsg:'<div style="padding:30px">'+base.lang.js_base_login_tip+"</div>",callback:function(){$(".btnTipsubmit").find(".buttonText").text(base.lang.js_base_login_btn)},scallback:function(){var e=encodeURIComponent(window.location.href);window.location.href="/index/reg.html?loginurl="+e+""}}),t=!1),t},shareweinxtip=function(e){var t=$(".share_tip").size(),n=$('<div id="share_bg_'+t+'" class="share_bg" data-index="'+t+'"></div>'),r=$('<div id="share_tip_'+t+'" class="share_tip '+e.class+'" data-index="'+t+'"></div>');$("body").append(n),$("body").append(r),$("#share_bg_"+t).show().css({"z-index":t+99990}),$("#share_tip_"+t).show().css({"z-index":t+99991}),e.callback&&e.callback($("#share_tip_"+t),$("#share_bg_"+t)),e.isclose!=0&&($("#share_tip_"+t).unbind("click").bind("click",function(){$("#share_tip_"+t).remove(),$("#share_bg_"+t).remove()}),$("#share_bg_"+t).unbind("click").bind("click",function(){$("#share_tip_"+t).remove(),$("#share_bg_"+t).remove()}))},closeTip=function(e,t){var n=e.attr("data-index"),r=1;t&&(r=t),tip.centerDivClosed({indexNum:n,indexTipDiv:e,type:r})},baiduShare=function(options){var settings={bdPic:"",bdText:"",url:"",title:"",desc:"",summary:"",site:"www.byshare.com",baidu:0};options&&$.extend(settings,options);if(settings.baidu==1){window._bd_share_config={common:{bdSnsKey:{tsina:3171756207},bdText:"",bdMini:"2",bdPic:settings.bdPic,bdStyle:"0",bdSize:"16"},share:{}};with(document)(0)[(getElementsByTagName("head")[0]||body).appendChild(createElement("script")).src="http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion="+~(-(new Date)/36e5)]}else{var share_Sina=function(){return'<a href="http://v.t.sina.com.cn/share/share.php?url='+encodeURIComponent(settings.url)+"&amp;title="+settings.title+"&amp;appkey=3171756207&amp;pic="+settings.bdPic+'" target="_blank" class="byshare_sns byshare_tsina" title="分享到新浪微博"></a>'},share_qqQzone=function(){return'<a href="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url='+encodeURIComponent(settings.url)+"&title="+encodeURI(settings.title)+"&pics="+settings.bdPic+"&summary="+encodeURI(settings.summary)+'" target="_blank" class="byshare_sns byshare_qzone" data-cmd="qzone" title="分享到QQ空间"></a>'},share_qq=function(){return'<a href="http://connect.qq.com/widget/shareqq/index.html?url='+settings.url+"&showcount=0&desc="+encodeURI(settings.desc)+"&summary="+encodeURI(settings.summary)+encodeURI(settings.url)+"&title="+encodeURI(settings.title)+"&site="+settings.site+"&pics="+settings.bdPic+'" class="byshare_sns byshare_qzone" data-cmd="qzone" title="分享到QQ空间"></a>'},share_weiXin=function(){wx.onMenuShareTimeline({title:"",link:"",imgUrl:"",success:function(){alert(11)},cancel:function(){alert(222)}})},html="";html+=share_qqQzone(),html+=share_Sina(),$("#share_sns").html(html)}},gzweixin=function(e){var t={callback:null,errcallback:null};$.extend(!0,t,e),ajax.ajaxInit({url:"/user/weixin_isguanzhu.html",params:{},callback:function(n){isback=1,$("#testStatus").text(n.status);if(n.status==1)isgzweixin=1,e.callback&&t.callback();else if(n.status==-1)islogin==0&&(window.location.href="/index/reg.html"),config.tip.tips({htmlmsg:'<div style="padding:30px">'+n.msg+"</div>",type:0,scallback:function(){window.location.href="http://mp.weixin.qq.com/s?__biz=MzA3NTM5Mzg2NA==&mid=206134523&idx=1&sn=b052274af6c6633a2e2db14c7a10e577#rd"}});else{var r=0;$(".headerbox").length>0&&(r=$(".headerbox").height()),$("#gzweixin").css({top:r}).show(),$("#gzclose").unbind("click").bind("click",function(){$("#gzweixin").hide()}),e.errcallback&&t.errcallback(n.msg)}}})},goTopExUtils=function(e){var t=e.divid;t.bind("click",function(){$("html,body").animate({scrollTop:0},100),t.hide()});var n=function(){return document.body.scrollTop+document.documentElement.scrollTop},r=function(e){navigator.appName=="Netscape"&&navigator.userAgent.toUpperCase().indexOf("CHROME")>0?document.body.scrollTop=e:document.documentElement.scrollTop=e};window.onscroll=function(){n()>0?t.fadeIn():t.fadeOut()}};return{base:base,tip:tip,loginCheck:loginCheck,shareweinxtip:shareweinxtip,closeTip:closeTip,baiduShare:baiduShare,gzweixin:gzweixin,goTopExUtils:goTopExUtils}}),define("ajax",["jquery","config"],function(e,t){var n=function(n){var r={url:"",type:"post",dataType:"json",params:{ajax:1},yzlogin:!1,isloading:!1,callback:function(){},errCallback:function(){}};n&&e.extend(!0,r,n);if(r.yzlogin){var i=t.loginCheck();if(!i)return!1}r.isloading==1&&t.base.loadInit({status:1}),e.ajax({url:r.url,type:r.type,dataType:r.dataType,data:r.params,success:function(i){r.isloading==1&&t.base.loadInit({status:0});if(i.status==900)return e(".loadingMask").remove(),t.tip.tips({htmlmsg:'<div style="padding:30px">'+t.base.lang.js_base_login_tip+"</div>",callback:function(){e(".btnTipsubmit").find(".buttonText").text(t.base.lang.js_base_login_btn)},scallback:function(){var e=window.location.href;window.location.href="/index/reg.html?loginurl="+e+""}}),!1;n.callback&&r.callback(i)},error:function(e){t.base.loadInit({status:0}),n.errCallback?r.errCallback(e):t.tip.tips({htmlmsg:'<div style="padding:30px">请求超时，请重试！</div>',type:0,scallback:function(){window.location.reload()}})}})};return{ajaxInit:n}}),define("comm/gzweixin",["jquery","config","ajax"],function(e,t,n){var r=function(r){if(isweixin!=1)return!1;var i={callback:null,errcallback:null};e.extend(!0,i,r),n.ajaxInit({url:"/user/weixin_isguanzhu.html",params:{},callback:function(n){isback=1,e("#testStatus").text(n.status);if(n.status==1)isgzweixin=1,r.callback&&i.callback();else if(n.status==-1)islogin==0&&(window.location.href="/index/reg.html"),t.tips({htmlmsg:'<div style="padding:30px">'+n.msg+"</div>",type:0,scallback:function(){window.location.href="http://mp.weixin.qq.com/s?__biz=MzA3NTM5Mzg2NA==&mid=206134523&idx=1&sn=b052274af6c6633a2e2db14c7a10e577#rd"}});else{var s=0;e(".headerbox").length>0&&(s=e(".headerbox").height()),e("#gzweixin").css({top:s}).show(),e("#gzclose").unbind("click").bind("click",function(){e("#gzweixin").hide()}),r.errcallback&&i.errcallback(n.msg)}}})};return{gzweixin:r}}),function(e){typeof define=="function"&&define.amd?define("plugin/checkImgExists",["jquery"],e):e(jQuery)}(function(e){e.fn.checkImgExists=function(t){e(this).each(function(n,r){var i=e(this),s=i.attr("data-original"),o=i.attr("src"),u=new Image;u.src=s,u.onload=function(){i.attr("src",s);if(t){var e={w:u.width,h:u.height};t(i,s,e)}},u.onerror=function(){t&&t(i,o)}})}}),function(e){typeof define=="function"&&define.amd?define("lazyload",["jquery"],e):e(jQuery)}(function(e){!function(e,t,n,r){var i=e(t);e.fn.lazyload=function(s){function o(){var t=0;f.each(function(){var n=e(this);if(!l.skip_invisible||n.is(":visible"))if(!e.abovethetop(this,l)&&!e.leftofbegin(this,l))if(e.belowthefold(this,l)||e.rightoffold(this,l)){if(++t>l.failure_limit)return!1}else n.trigger("appear"),t=0})}var u,f=this,l={threshold:0,failure_limit:0,event:"scroll",effect:"show",container:t,data_attribute:"original",skip_invisible:!1,appear:null,load:null,placeholder:"data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="};return s&&(r!==s.failurelimit&&(s.failure_limit=s.failurelimit,delete s.failurelimit),r!==s.effectspeed&&(s.effect_speed=s.effectspeed,delete s.effectspeed),e.extend(l,s)),u=l.container===r||l.container===t?i:e(l.container),0===l.event.indexOf("scroll")&&u.bind(l.event,function(){return o()}),this.each(function(){var t=this,n=e(t);t.loaded=!1,(n.attr("src")===r||n.attr("src")===!1)&&n.is("img")&&n.attr("src",l.placeholder),n.one("appear",function(){if(!this.loaded){if(l.appear){var r=f.length;l.appear.call(t,r,l)}e("<img />").bind("load",function(){var r=n.attr("data-"+l.data_attribute);n.hide(),n.is("img")?n.attr("src",r):n.css("background-image","url('"+r+"')"),n[l.effect](l.effect_speed),t.loaded=!0;var i=e.grep(f,function(e){return!e.loaded});if(f=e(i),l.load){var s=f.length;l.load.call(t,s,l)}}).attr("src",n.attr("data-"+l.data_attribute))}}),0!==l.event.indexOf("scroll")&&n.bind(l.event,function(){t.loaded||n.trigger("appear")})}),i.bind("resize",function(){o()}),/(?:iphone|ipod|ipad).*os 5/gi.test(navigator.appVersion)&&i.bind("pageshow",function(t){t.originalEvent&&t.originalEvent.persisted&&f.each(function(){e(this).trigger("appear")})}),e(n).ready(function(){o()}),this},e.belowthefold=function(n,s){var o;return o=s.container===r||s.container===t?(t.innerHeight?t.innerHeight:i.height())+i.scrollTop():e(s.container).offset().top+e(s.container).height(),o<=e(n).offset().top-s.threshold},e.rightoffold=function(n,s){var o;return o=s.container===r||s.container===t?i.width()+i.scrollLeft():e(s.container).offset().left+e(s.container).width(),o<=e(n).offset().left-s.threshold},e.abovethetop=function(n,s){var o;return o=s.container===r||s.container===t?i.scrollTop():e(s.container).offset().top,o>=e(n).offset().top+s.threshold+e(n).height()},e.leftofbegin=function(n,s){var o;return o=s.container===r||s.container===t?i.scrollLeft():e(s.container).offset().left,o>=e(n).offset().left+s.threshold+e(n).width()},e.inviewport=function(t,n){return!(e.rightoffold(t,n)||e.leftofbegin(t,n)||e.belowthefold(t,n)||e.abovethetop(t,n))},e.extend(e.expr[":"],{"below-the-fold":function(t){return e.belowthefold(t,{threshold:0})},"above-the-top":function(t){return!e.belowthefold(t,{threshold:0})},"right-of-screen":function(t){return e.rightoffold(t,{threshold:0})},"left-of-screen":function(t){return!e.rightoffold(t,{threshold:0})},"in-viewport":function(t){return e.inviewport(t,{threshold:0})},"above-the-fold":function(t){return!e.belowthefold(t,{threshold:0})},"right-of-fold":function(t){return e.rightoffold(t,{threshold:0})},"left-of-fold":function(t){return!e.rightoffold(t,{threshold:0})}})}(jQuery,window,document)}),define("base",["jquery","config","ajax","comm/gzweixin","plugin/checkImgExists","lazyload"],function(e,t,n,r){var i=function(){if(e("#viewpage").size()<=0&&e("#index_ad").size()<=0){var t=e(".headerbox").height();e(".mainbox").css({"padding-top":t})}e("img.lazy,img.avatar_lazy").lazyload({effect:"fadeIn",threshold:500,failurelimit:100,skip_invisible:!1}),e("body").delegate(".back-btn","click",function(){window.history.back()}),e(".cartItemnum").size()>0&&a(),s(),c(),f(),u({topdiv:e("#topButton")}),r.gzweixin({}),l(),o()},s=function(){function t(t){var o=e('<div id="search-modalMask" class="modalMask" style="z-index:9996;display: block"></div>');e("body").append(o);var u="/common/gettpl.html?name=sns_searchinput&ch=sns";t.searchtype=="weixingroup"&&(u="/common/gettpl.html?name=sns_searchgroup&ch=sns"),n.ajaxInit({url:u,type:"GET",dataType:"html",params:{},callback:function(t){e("body").append(t);var o="goods";e("#searchinput").addClass("loaded"),e("#newsearchInt").focus(),e("#searchtyleval").val(o),r(),s(),i(),e("#qingkong_btn").unbind("click").bind("click",function(){n.ajaxInit({url:"/m_search/clearwords.html",params:"",callback:function(t){t.status==1&&(e("#searchTagbox").html(""),e("#qingkong_btn").hide())}})})}})}function r(){e("#s-input-tab-txt").unbind("click").bind("click",function(){var t=e("#J_TabNav").is(":hidden");t?e("#J_TabNav").show():e("#J_TabNav").hide()}),e("#s-input-tab-txt").find("li").unbind("click").bind("click",function(){var t=e(this).text(),n=e(this).attr("data-val");e("#s-input-val").text(t),e("#s-input-val").attr("data-type",n),e("#searchtyleval").val(n),s()})}function i(){e("#closeSearch,#search-modalMask").unbind("click").bind("click",function(){e("#searchinput").remove(),e("#search-modalMask").remove()})}function s(t){function s(){n.ajaxInit({url:"/m_search/getwordlists.html?t="+r+"&s="+i+"",params:{},callback:function(t){if(t.status){e("#searchTagbox").show();var n=t.data.keyword,s='<li class="li-title">历史记录</li>';i==""&&(s='<li class="li-title">历史记录</li>',e("#qingkong_btn").show()),e.each(n,function(e,t){s+='<li><a href="/m_search/search.html?t='+r+"&s="+encodeURIComponent(t.val)+'" data-val='+t.val+">"+t.val+"</a></li>"}),e("#searchTagbox").html(s)}else e("#searchTagbox").hide(),e("#qingkong_btn").hide()}})}var r=e("#searchtyleval").val(),i="";e("#newsearchInt").unbind("input").bind("input",function(){var t=e(this);r=e("#s-input-val").attr("data-type"),i=e.trim(t.val()),s()}),s()}e(".searchstart").unbind("focus").bind("focus",function(){var n=e(this).attr("data-placeholder"),r=e(this).attr("data-searchtype");t({placeholder:n,searchtype:r})}),e(".searchtop").unbind("click").bind("click",function(){var n=e(this).attr("data-placeholder"),r=e(this).attr("data-searchtype");t({placeholder:n,searchtype:r})})},o=function(){function n(e){var t=document.body.scrollTop,e=e||function(){};window.addEventListener("scroll",function(){var n=document.body.scrollTop,r=n-t;if(r===0)return!1;e(r>0?"down":"up"),t=n},!1)}var t=e("#carfooter").size()>0?1:0;n(function(n){var r=n;r=="up"?(e("#headerbox").show(),t||e("#footerbox").show()):r=="down"&&(t||e("#footerbox").hide(),e("#headerbox").hide())})},u=function(t){var n=t.topdiv;n.bind("click",function(){e("html,body").animate({scrollTop:0},100),n.hide()});var r=function(){return document.body.scrollTop+document.documentElement.scrollTop},i=function(e){navigator.appName=="Netscape"&&navigator.userAgent.toUpperCase().indexOf("CHROME")>0?document.body.scrollTop=e:document.documentElement.scrollTop=e};window.onscroll=function(){r()>0?n.fadeIn():n.fadeOut()}},a=function(){if(islogin==0)return e(".cartItemnum").hide(),!1;n.ajaxInit({url:"/myorder/getcart.html",params:{partdata:"goods"},callback:function(t){var n=t.data.itemnum;n>0?(e(".cartItemnum").html(n).show(),e(".cartItemnum").html(n).show()):(e(".cartItemnum").hide(),e(".cartItemnum").html(n).show())}})},f=function(){var t=e("#send").attr("data-suid");n.ajaxInit({url:"/message/getmsgnum.html",params:{suid:t},callback:function(t){t.status==1&&e(".infomore_num,.infomnum").text(t.data.num).show()}}),e(".infomore_btn").unbind("click").bind("click",function(){var t=e(this).parents(".top_r"),n=t.find(".infomore").is(":hidden");n?t.find(".infomore").show():t.find(".infomore").hide(),e(document).unbind("click").bind("click",function(n){var r=e(n.target);r.closest(e(".infomore_btn")).length==0&&t.find(".infomore").hide()})})},l=function(){if(urlfee_fromsuid&&urlfee_url){setTimeout(e,5e3);function e(){n.ajaxInit({url:"/mk_market/urlfee.html",params:{fromsuid:urlfee_fromsuid,url:urlfee_url},callback:function(e){}})}}},c=function(){e(".shareUpload").unbind("click").bind("click",function(){e("#addbox").show(),e("body").css({overflow:"hidden"}),e("#addbox_bg,#addbox_btn").unbind("click").bind("click",function(){e("#addbox").hide(),e("body").css({overflow:"auto"})})}),e(".add-share").unbind("click").bind("click",function(){var n=e(this).attr("data-ismjx"),r=t.loginCheck();if(!r)return!1;require(["up"],function(e){e.uploadInit({tip:!0,uptitle:"请选择1~5张图片上传",yzlogin:!0,container:"allcontainer",browse_button:"allpickfiles",drop_element:"allcontainer",isarray:!0,bucket:"share",isarray:!0,multi_selection:!0,auto_start:!0,fileNumLimit:5,callback:function(t){var r=t;e.successFun(r,{ismjx:n})},bcallback:function(){}})})})};return{init:i,getCartInit:a}}),function(e){typeof define=="function"&&define.amd?define("jquerypjax",["jquery"],e):e(jQuery)}(function(e){(function(e){function t(t,r,i){var s=this;return this.on("click.pjax",t,function(t){var o=e.extend({},v(r,i));o.container||(o.container=e(this).attr("data-pjax")||s),n(t,o)})}function n(t,n,r){r=v(n,r);var s=t.currentTarget;if(s.tagName.toUpperCase()!=="A")throw"$.fn.pjax or $.pjax.click requires an anchor element";if(t.which>1||t.metaKey||t.ctrlKey||t.shiftKey||t.altKey)return;if(location.protocol!==s.protocol||location.hostname!==s.hostname)return;if(s.hash&&s.href.replace(s.hash,"")===location.href.replace(location.hash,""))return;if(s.href===location.href+"#")return;var o={url:s.href,title:s.title,imgurl:e(s).attr("data-img"),container:e(s).attr("data-pjax"),target:s},u=e.extend({},o,r),a=e.Event("pjax:click");e(s).trigger(a,[u]),a.isDefaultPrevented()||(i(u),t.preventDefault())}function r(t,n,r){r=v(n,r);var s=t.currentTarget;if(s.tagName.toUpperCase()!=="FORM")throw"$.pjax.submit requires a form element";var o={type:s.method.toUpperCase(),url:s.action,data:e(s).serializeArray(),container:e(s).attr("data-pjax"),target:s};i(e.extend({},o,r)),t.preventDefault()}function i(t){function u(t,r){var i=e.Event(t,{relatedTarget:n});return s.trigger(i,r),!i.isDefaultPrevented()}t=e.extend(!0,{},e.ajaxSettings,i.defaults,t),e.isFunction(t.url)&&(t.url=t.url());var n=t.target,r=d(t.url).hash,s=t.context=m(t.container);t.data||(t.data={}),t.data._pjax=s.selector;var a;t.beforeSend=function(e,n){n.type!=="GET"&&(n.timeout=0),e.setRequestHeader("X-PJAX","true"),e.setRequestHeader("X-PJAX-Container",s.selector);if(!u("pjax:beforeSend",[e,n]))return!1;n.timeout>0&&(a=setTimeout(function(){u("pjax:timeout",[e,t])&&e.abort("timeout")},n.timeout),n.timeout=0),t.requestUrl=d(n.url).href},t.complete=function(e,n){a&&clearTimeout(a),u("pjax:complete",[e,n,t]),u("pjax:end",[e,t])},t.error=function(e,n,r){var i=b("",e,t),s=u("pjax:error",[e,n,r,t]);t.type=="GET"&&n!=="abort"&&s&&o(i.url)},t.success=function(n,a,f){var l=typeof e.pjax.defaults.version=="function"?e.pjax.defaults.version():e.pjax.defaults.version,c=f.getResponseHeader("X-PJAX-Version"),p=b(n,f,t);if(l&&c&&l!==c){o(p.url);return}if(!p.contents){o(p.url);return}i.state={id:t.id||h(),url:p.url,title:p.title,container:s.selector,fragment:t.fragment,timeout:t.timeout},p.title=t.title,(t.push||t.replace)&&window.history.replaceState(i.state,p.title,p.url),document.activeElement.blur(),p.title&&(document.title=p.title),e("#weixin_first_img").length>0&&t.imgurl&&e("#weixin_first_img").attr("src",t.imgurl),s.html(p.contents);var v=s.find("input[autofocus], textarea[autofocus]").last()[0];v&&document.activeElement!==v&&v.focus(),w(p.scripts),typeof t.scrollTo=="number"&&e(window).scrollTop(t.scrollTo);if(r!==""){var m=d(p.url);m.hash=r,i.state.url=m.href,window.history.replaceState(i.state,p.title,m.href);var g=e(m.hash);g.length&&e(window).scrollTop(g.offset().top)}u("pjax:success",[n,a,f,t])};if(!i.state){var f="";e("#weixin_first_img").length>0&&(f=e("#weixin_first_img").attr("src")),i.state={id:h(),url:window.location.href,title:document.title,imgurl:f,container:s.selector,fragment:t.fragment,timeout:t.timeout},window.history.replaceState(i.state,document.title)}var l=i.xhr;l&&l.readyState<4&&(l.onreadystatechange=e.noop,l.abort()),i.options=t;var l=i.xhr=e.ajax(t);return l.readyState>0&&(t.push&&!t.replace&&(T(i.state.id,s.clone().contents()),window.history.pushState(null,"",p(t.requestUrl))),u("pjax:start",[l,t]),u("pjax:send",[l,t])),i.xhr}function s(t,n){var r={url:window.location.href,push:!1,replace:!0,scrollTo:!1};return i(e.extend(r,v(t,n)))}function o(e){window.history.replaceState(null,"","#"),window.location.replace(e)}function l(t){var n=t.state;if(n&&n.container){if(u&&a==n.url)return;if(i.state.id===n.id)return;var r=e(n.container);if(r.length){var s,f=E[n.id];i.state&&(s=i.state.id<n.id?"forward":"back",N(s,i.state.id,r.clone().contents()));var l=e.Event("pjax:popstate",{state:n,direction:s});r.trigger(l);var c={id:n.id,url:n.url,container:r,push:!1,fragment:n.fragment,timeout:n.timeout,scrollTo:!1};f?(r.trigger("pjax:start",[null,c]),n.title&&(document.title=n.title),e("#weixin_first_img").length>0&&n.imgurl&&e("#weixin_first_img").attr("src",n.imgurl),r.html(f),i.state=n,r.trigger("pjax:end",[null,c])):i(c),r[0].offsetHeight}else o(location.href)}e("body").css({overflow:"auto"}),u=!1}function c(t){var n=e.isFunction(t.url)?t.url():t.url,r=t.type?t.type.toUpperCase():"GET",i=e("<form>",{method:r==="GET"?"GET":"POST",action:n,style:"display:none"});r!=="GET"&&r!=="POST"&&i.append(e("<input>",{type:"hidden",name:"_method",value:r.toLowerCase()}));var s=t.data;if(typeof s=="string")e.each(s.split("&"),function(t,n){var r=n.split("=");i.append(e("<input>",{type:"hidden",name:r[0],value:r[1]}))});else if(typeof s=="object")for(key in s)i.append(e("<input>",{type:"hidden",name:key,value:s[key]}));e(document.body).append(i),i.submit()}function h(){return(new Date).getTime()}function p(e){return e.replace(/\?_pjax=[^&]+&?/,"?").replace(/_pjax=[^&]+&?/,"").replace(/[\?&]$/,"")}function d(e){var t=document.createElement("a");return t.href=e,t}function v(t,n){return t&&n?n.container=t:e.isPlainObject(t)?n=t:n={container:t},n.container&&(n.container=m(n.container)),n}function m(t){t=e(t);if(!t.length)throw"no pjax container for "+t.selector;if(t.selector!==""&&t.context===document)return t;if(t.attr("id"))return e("#"+t.attr("id"));throw"cant get selector for pjax container!"}function g(e,t){return e.filter(t).add(e.find(t))}function y(t){return e.parseHTML(t,document,!0)}function b(t,n,r){var i={};i.url=p(n.getResponseHeader("X-PJAX-URL")||r.requestUrl);if(/<html/i.test(t))var s=e(y(t.match(/<head[^>]*>([\s\S.]*)<\/head>/i)[0])),o=e(y(t.match(/<body[^>]*>([\s\S.]*)<\/body>/i)[0]));else var s=o=e(y(t));if(o.length===0)return i;i.title=g(s,"title").last().text();if(r.fragment){if(r.fragment==="body")var u=o;else var u=g(o,r.fragment).first();u.length&&(i.contents=u.contents(),i.title||(i.title=u.attr("title")||u.data("title")))}else/<html/i.test(t)||(i.contents=o);return i.contents&&(i.contents=i.contents.not(function(){return e(this).is("title")}),i.contents.find("title").remove(),i.scripts=g(i.contents,"script[src]").remove(),i.contents=i.contents.not(i.scripts)),i.title&&(i.title=e.trim(i.title)),i}function w(t){if(!t)return;var n=e("script[src]");t.each(function(){var t=this.src,r=n.filter(function(){return this.src===t});if(r.length)return;var i=document.createElement("script");i.type=e(this).attr("type"),i.src=e(this).attr("src"),document.head.appendChild(i)})}function T(e,t){E[e]=t,x.push(e);while(S.length)delete E[S.shift()];while(x.length>i.defaults.maxCacheLength)delete E[x.shift()]}function N(e,t,n){var r,i;E[t]=n,e==="forward"?(r=x,i=S):(r=S,i=x),r.push(t),(t=i.pop())&&delete E[t]}function C(){return e("meta").filter(function(){var t=e(this).attr("http-equiv");return t&&t.toUpperCase()==="X-PJAX-VERSION"}).attr("content")}function k(){e.fn.pjax=t,e.pjax=i,e.pjax.enable=e.noop,e.pjax.disable=L,e.pjax.click=n,e.pjax.submit=r,e.pjax.reload=s,e.pjax.defaults={timeout:2e3,push:!0,replace:!1,type:"GET",dataType:"html",scrollTo:!1,maxCacheLength:20,version:C},e(window).on("popstate.pjax",l)}function L(){e.fn.pjax=function(){return this},e.pjax=c,e.pjax.enable=k,e.pjax.disable=e.noop,e.pjax.click=e.noop,e.pjax.submit=e.noop,e.pjax.reload=function(){window.location.reload()},e(window).off("popstate.pjax",l)}var u=!0,a=window.location.href,f=window.history.state;f&&f.container&&(i.state=f),"state"in window.history&&(u=!1);var E={},S=[],x=[];e.inArray("state",e.event.props)<0&&e.event.props.push("state"),e.support.pjax=window.history&&window.history.pushState&&window.history.replaceState&&!navigator.userAgent.match(/((iPod|iPhone|iPad).+\bOS\s+[1-4]|WebApps\/.+CFNetwork)/),e.support.pjax?k():L()})(jQuery)}),define("pjax",["jquery","config","jquerypjax"],function(e,t){var n=function(){if(e("#appendbox").length>0)return!1;e("body").append('<div id="appendbox"></div>'),e("body").append('<div id="viewloadingMask" class="loadingMask" style="z-index:9989;display:none"></div>'),e(document).pjax("a.pjax","#appendbox"),e(document).on("pjax:send",function(){e("#loadingMask").show()}),e(document).on("pjax:complete",function(){e("#viewpage").find(".contentbox").addClass("viewpage canClose"),e("#viewpage").find(".headerbox_view").css({"z-index":1003}),e("#appendbox").append('<div class="viewpage_bg" style="z-index:1001;"></div>'),e("#loadingMask").hide(),e("body").css({overflow:"hidden"});var t="goods";require(["share"],function(e){shareView=1,e.shareViewcomm()})})};return{pjaxInt:n}}),function(e){typeof define=="function"&&define.amd?define("infinitescroll",["jquery"],e):e(jQuery)}(function(e,t){"use strict";e.infinitescroll=function(n,r,i){this.element=e(i),this._create(n,r)||(this.failed=!0)},e.infinitescroll.defaults={loading:{finished:t,finishedMsg:"<em>Congratulations, you've reached the end of the internet.</em>",img:"",msg:null,msgText:"<em>Loading the next set of posts...</em>",selector:null,speed:"fast",start:t},state:{isDuringAjax:!1,isInvalidPage:!1,isDestroyed:!1,isDone:!1,isPaused:!1,isBeyondMaxPage:!1,currPage:1},debug:!1,behavior:t,binder:e(window),nextSelector:"div.navigation a:first",navSelector:"div.navigation",contentSelector:null,extraScrollPx:150,itemSelector:"div.post",animate:!1,pathParse:t,dataType:"html",appendCallback:!1,bufferPx:40,errorCallback:function(){},infid:0,pixelsFromNavToBottom:t,path:t,prefill:!1,maxPage:t},e.infinitescroll.prototype={_binding:function(n){var r=this,i=r.options;i.v="2.0b2.120520";if(!!i.behavior&&this["_binding_"+i.behavior]!==t){this["_binding_"+i.behavior].call(this);return}if(n!=="bind"&&n!=="unbind")return this._debug("Binding value  "+n+" not valid"),!1;n==="unbind"?this.options.binder.unbind("smartscroll.infscr."+r.options.infid):this.options.binder[n]("smartscroll.infscr."+r.options.infid,function(){r.scroll()}),this._debug("Binding",n)},_create:function(r,i){var s=e.extend(!0,{},e.infinitescroll.defaults,r);this.options=s;var o=e(window),u=this;if(!u._validate(r))return!1;var a=e(s.nextSelector).attr("href"),f=e(this.element).find(".item").eq(0).attr("data-page");f&&(a=f);if(!a)return this._debug("Navigation selector not found"),!1;s.path=s.path||this._determinepath(a),s.contentSelector=s.contentSelector||this.element,s.loading.selector=s.loading.selector||s.contentSelector,s.loading.msg=s.loading.msg||e('<div id="data-loading" class="rel data-loading" style="display:none"><div class="infscr-loading" id="infscr-loading" style="text-align:center"><img alt="Loading..." src="'+s.loadingImg+'" /></div></div>"'),(new Image).src=s.loading.img,s.pixelsFromNavToBottom===t&&(s.pixelsFromNavToBottom=e(document).height()-e(s.navSelector).offset().top,console.log(s.pixelsFromNavToBottom),this._debug("pixelsFromNavToBottom: "+s.pixelsFromNavToBottom));var l=this;return s.loading.start=s.loading.start||function(){e(s.navSelector).hide(),s.loading.selector.after(s.loading.msg),s.loading.msg.show(s.loading.speed,e.proxy(function(){this.beginAjax(s)},l))},s.loading.finished=s.loading.finished||function(){s.state.isBeyondMaxPage||s.loading.msg.fadeOut(s.loading.speed)},s.callback=function(n,r,u){!!s.behavior&&n["_callback_"+s.behavior]!==t&&n["_callback_"+s.behavior].call(e(s.contentSelector)[0],r,u),i&&i.call(e(s.contentSelector)[0],r,s,u),s.prefill&&o.bind("resize.infinite-scroll",n._prefill)},r.debug&&Function.prototype.bind&&(typeof console=="object"||typeof console=="function")&&typeof console.log=="object"&&["log","info","warn","error","assert","dir","clear","profile","profileEnd"].forEach(function(e){console[e]=this.call(console[e],console)},Function.prototype.bind),this._setup(),s.prefill&&this._prefill(),!0},_prefill:function(){function i(){return e(n.options.contentSelector).height()<=r.height()}var n=this,r=e(window);this._prefill=function(){i()&&n.scroll(),r.bind("resize.infinite-scroll",function(){i()&&(r.unbind("resize.infinite-scroll"),n.scroll())})},this._prefill()},_debug:function(){if(!0!==this.options.debug)return;typeof console!="undefined"&&typeof console.log=="function"?Array.prototype.slice.call(arguments).length===1&&typeof Array.prototype.slice.call(arguments)[0]=="string"?console.log(Array.prototype.slice.call(arguments).toString()):console.log(Array.prototype.slice.call(arguments)):!Function.prototype.bind&&typeof console!="undefined"&&typeof console.log=="object"&&Function.prototype.call.call(console.log,console,Array.prototype.slice.call(arguments))},_determinepath:function(r){var i=this.options;if(!i.behavior||this["_determinepath_"+i.behavior]===t)return r.match(/^(.*?page=)\d(.*)/)?(r=r.match(/^(.*?page=)\d(.*)/).slice(1),r):e.isFunction(i.pathParse)?[r]:(props.isInvalidPage=!0,this._debug("determinePath",r),r);return this["_determinepath_"+i.behavior].call(this,r)},_error:function(n){var r=this.options;if(!!r.behavior&&this["_error_"+r.behavior]!==t){this["_error_"+r.behavior].call(this,n);return}n!=="destroy"&&n!=="end"&&(n="unknown"),this._debug("Error",n),(n==="end"||r.state.isBeyondMaxPage)&&this._showdonemsg(),r.state.isDone=!0,r.state.currPage=1,r.state.isPaused=!1,r.state.isBeyondMaxPage=!1,this._binding("unbind")},_loadcallback:function(r,i,s){var o=this.options,u=this.options.callback,a=o.state.isDone?"done":o.appendCallback?"append":"no-append",f;if(!!o.behavior&&this["_loadcallback_"+o.behavior]!==t){this["_loadcallback_"+o.behavior].call(this,r,i,s);return}switch(a){case"done":return this._showdonemsg(),!1;case"no-append":o.dataType==="html"&&(i="<div>"+i+"</div>",i=e(i).find(o.itemSelector));if(i.length===0)return this._error("end");break;case"append":var l=r.children();if(l.length===0)return this._error("end");f=document.createDocumentFragment();while(r[0].firstChild)f.appendChild(r[0].firstChild);this._debug("contentSelector",e(o.contentSelector)[0]),e(o.contentSelector)[0].appendChild(f),i=l.get();var c=e(e(i).find(".item").prevObject[0]).attr("data-page");if(o.searchflag||c)o.desturl=c}o.loading.finished.call(e(o.contentSelector)[0],o);if(o.animate){var h=e(window).scrollTop()+e(o.loading.msg).height()+o.extraScrollPx+"px";e("html,body").animate({scrollTop:h},800,function(){o.state.isDuringAjax=!1})}o.animate||(o.state.isDuringAjax=!1),u(this,i,s),o.prefill&&this._prefill()},_nearbottom:function(){var r=this.options,i=0+e(document).height()-r.binder.scrollTop()-e(window).height();return!r.behavior||this["_nearbottom_"+r.behavior]===t?(this._debug("math:",i,r.pixelsFromNavToBottom),i/2-r.bufferPx<r.pixelsFromNavToBottom):this["_nearbottom_"+r.behavior].call(this)},_pausing:function(n){var r=this.options;if(!r.behavior||this["_pausing_"+r.behavior]===t){n!=="pause"&&n!=="resume"&&n!==null&&this._debug("Invalid argument. Toggling pause value instead"),n=!n||n!=="pause"&&n!=="resume"?"toggle":n;switch(n){case"pause":r.state.isPaused=!0;break;case"resume":r.state.isPaused=!1;break;case"toggle":r.state.isPaused=!r.state.isPaused}return this._debug("Paused",r.state.isPaused),!1}this["_pausing_"+r.behavior].call(this,n);return},_setup:function(){var n=this.options;if(!n.behavior||this["_setup_"+n.behavior]===t)return this._binding("bind"),!1;this["_setup_"+n.behavior].call(this);return},_showdonemsg:function(){var r=this.options;if(!!r.behavior&&this["_showdonemsg_"+r.behavior]!==t){this["_showdonemsg_"+r.behavior].call(this);return}r.loading.msg.find("img").hide().parent().find("div").html(r.loading.finishedMsg).animate({opacity:1},2e3,function(){e(this).parent().fadeOut(r.loading.speed)}),r.errorCallback.call(e(r.contentSelector)[0],"done")},_validate:function(n){for(var r in n)if(r.indexOf&&r.indexOf("Selector")>-1&&e(n[r]).length===0)return this._debug("Your "+r+" found no elements."),!1;return!0},bind:function(){this._binding("bind")},destroy:function(){return this.options.state.isDestroyed=!0,this.options.loading.finished(),this._error("destroy")},pause:function(){this._pausing("pause")},resume:function(){this._pausing("resume")},beginAjax:function(r){var i=this,s=r.path,o,u,a,f;r.state.currPage++;if(r.maxPage!==t&&r.state.currPage>r.maxPage){r.state.isBeyondMaxPage=!0,this.destroy();return}o=e(r.contentSelector).is("table, tbody")?e("<tbody/>"):e("<div/>"),r.searchflag&&r.desturl?u=r.desturl:u=typeof s=="function"?s(r.state.currPage):s.join(r.state.currPage),i._debug("heading into ajax",u),a=r.dataType==="html"||r.dataType==="json"?r.dataType:"html+callback",r.appendCallback&&r.dataType==="html"&&(a+="+callback");switch(a){case"html+callback":i._debug("Using HTML via .load() method"),o.load(u+" "+r.itemSelector,t,function(t){i._loadcallback(o,t,u)});break;case"html":i._debug("Using "+a.toUpperCase()+" via $.ajax() method"),e.ajax({url:u,dataType:r.dataType,complete:function(t,n){f=typeof t.isResolved!="undefined"?t.isResolved():n==="success"||n==="notmodified",f?i._loadcallback(o,t.responseText,u):i._error("end")}});break;case"json":i._debug("Using "+a.toUpperCase()+" via $.ajax() method"),e.ajax({dataType:"json",type:"GET",url:u,success:function(e,n,s){f=typeof s.isResolved!="undefined"?s.isResolved():n==="success"||n==="notmodified";if(r.appendCallback)if(r.template!==t){var a=r.template(e);o.append(a),f?i._loadcallback(o,a):i._error("end")}else i._debug("template must be defined."),i._error("end");else e.status?i._loadcallback(o,e,u):i._error("end")},error:function(){i._debug("JSON ajax request failed."),i._error("end")}})}},retrieve:function(r){r=r||null;var i=this,s=i.options;if(!!s.behavior&&this["retrieve_"+s.behavior]!==t){this["retrieve_"+s.behavior].call(this,r);return}if(s.state.isDestroyed)return this._debug("Instance is destroyed"),!1;s.state.isDuringAjax=!0,s.loading.start.call(e(s.contentSelector)[0],s)},scroll:function(){var n=this.options,r=n.state;if(!!n.behavior&&this["scroll_"+n.behavior]!==t){this["scroll_"+n.behavior].call(this);return}if(r.isDuringAjax||r.isInvalidPage||r.isDone||r.isDestroyed||r.isPaused)return;if(!this._nearbottom())return;this.retrieve()},toggle:function(){this._pausing()},unbind:function(){this._binding("unbind")},update:function(n){e.isPlainObject(n)&&(this.options=e.extend(!0,this.options,n))}},e.fn.infinitescroll=function(n,r){var i=typeof n;switch(i){case"string":var s=Array.prototype.slice.call(arguments,1);this.each(function(){var t=e.data(this,"infinitescroll");if(!t)return!1;if(!e.isFunction(t[n])||n.charAt(0)==="_")return!1;t[n].apply(t,s)});break;case"object":this.each(function(){var t=e.data(this,"infinitescroll");t?t=new e.infinitescroll(n,r,this):(t=new e.infinitescroll(n,r,this),t.failed||e.data(this,"infinitescroll",t))})}return this};var n=e.event,r;n.special.smartscroll={setup:function(){e(this).bind("scroll",n.special.smartscroll.handler)},teardown:function(){e(this).unbind("scroll",n.special.smartscroll.handler)},handler:function(t,n){var i=this,s=arguments;t.type="smartscroll",r&&clearTimeout(r),r=setTimeout(function(){e(i).trigger("smartscroll",s)},n==="execAsap"?0:100)}},e.fn.smartscroll=function(e){return e?this.bind("smartscroll",e):this.trigger("smartscroll",["execAsap"])}}),define("mas",["jquery","config","pjax","infinitescroll","lazyload"],function(e,t,n){var r=function(t){var n=e("#pagecol").val(),r=e("#isseacrch").val(),s=e("#types").val(),o=e("#isfollow").val(),u={dataType:"html",appendjsonback:null};t&&e.extend(!0,u,t);if(n==1){var a="masonry";t.div&&(a=t.div),r==1?i({masonry:a,dataType:u.dataType,issearch:!0,islazy:0,callback:function(){o==1&&require(["comm/followBtn"],function(e){e.followBtn()}),t.callback&&t.callback()},appendjsonback:u.appendjsonback}):i({masonry:a,dataType:u.dataType,issearch:!1,islazy:0,callback:function(){o&&require(["comm/followBtn"],function(e){e.followBtn()}),t.callback&&t.callback()},appendjsonback:u.appendjsonback})}else{var a="masonry_2";t.div&&(a=t.div),r==1?i({masonry:a,dataType:u.dataType,issearch:!0,islazy:1,callback:function(){o==1&&require(["comm/followBtn"],function(e){e.followBtn()}),t.callback&&t.callback()},appendjsonback:u.appendjsonback}):i({masonry:a,dataType:u.dataType,issearch:!1,islazy:1,callback:function(){o==1&&require(["comm/followBtn"],function(e){e.followBtn()}),t.callback&&t.callback()},appendjsonback:u.appendjsonback})}},i=function(t){var r={masonry:"masonry",navSelector:".pager",nextSelector:".pager .pager-next a",itemSelector:".item",resize:!0,islazy:!0,ispage:!0,threshold:1e3,failurelimit:20,issearch:!1,skip_invisible:!1,pathParse:"",dataType:"html",appendjsonback:null,w:1,h:4,callback:null};t&&e.extend(r,t);var i=e("#"+r.masonry),s,o=i.find(".item"),u=o.length;if(u<=0)return!1;n.pjaxInt();var a=function(e){i.find("img.lazy-mas").lazyload({effect:"fadeIn",threshold:r.threshold,failurelimit:r.failurelimit})},f=function(){i.find("img.lazy-mas").lazyload({effect:"fadeIn",threshold:r.threshold,failurelimit:r.failurelimit})};r.islazy==1?a():f();if(r.ispage){var l=!1;r.issearch&&(l=!0),i.infinitescroll({navSelector:r.navSelector,nextSelector:r.nextSelector,itemSelector:r.itemSelector,donetext:'<p style="padding-top:15px">No more pages to load.</p>',loadingImg:static_url+"/moblie/images/loading.gif",dataType:r.dataType,loading:{finished:function(){e("#data-loading").animate({opacity:.8},2e3).fadeOut("normal")}},bufferPx:400,pixelsFromNavToBottom:50,searchflag:l,pathParse:r.pathParse,errorCallback:function(){jQuery("#data-loading").animate({opacity:.8},2e3).fadeOut("normal")}},function(n){if(t.dataType=="json")return r.appendjsonback(n),t.callback&&r.callback(),!0;r.islazy==1?e(n).each(function(t,n){t%2==0?i.find(".rightbox").append(e(this)):i.find(".leftbox").append(e(this)),e(this).find("img.lazy-mas").lazyload({threshold:r.threshold,failurelimit:r.failurelimit})}):(e(n).appendTo(i),e("img.avatar_lazy").checkImgExists(function(e,t){var n=e,r=t,i=n.parent(".useravatar_bg");i.css({background:"url("+r+") no-repeat","background-size":"cover"})}),f()),t.callback&&r.callback()})}};return{init:r,masonryInit:i}});var baguetteBox=function(){function e(e,n){O.transforms=h(),O.svg=p(),t(),H=document.querySelectorAll(e),[].forEach.call(H,function(e){var t=e.getElementsByTagName("a");t=[].filter.call(t,function(e){return P.test(e.href)});var i=B.length;B.push(t),B[i].options=n,[].forEach.call(B[i],function(e,t){m(e,"click",function(e){e.preventDefault?e.preventDefault():e.returnValue=!1,r(i),s(t)})})})}function t(){return(b=g("baguetteBox-overlay"))?(w=g("baguetteBox-slider"),E=g("previous-button"),S=g("next-button"),void (x=g("close-button"))):(b=y("div"),b.id="baguetteBox-overlay",document.getElementsByTagName("body")[0].appendChild(b),w=y("div"),w.id="baguetteBox-slider",b.appendChild(w),E=y("button"),E.id="previous-button",E.innerHTML=O.svg?N:"&lt;",b.appendChild(E),S=y("button"),S.id="next-button",S.innerHTML=O.svg?C:"&gt;",b.appendChild(S),x=y("button"),x.id="close-button",x.innerHTML=O.svg?k:"X",b.appendChild(x),E.className=S.className=x.className="baguetteBox-button",void n())}function n(){m(b,"click",function(e){e.target&&"IMG"!==e.target.nodeName&&"FIGCAPTION"!==e.target.nodeName&&o()}),m(E,"click",function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,l()}),m(S,"click",function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,f()}),m(x,"click",function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,o()}),m(b,"touchstart",function(e){T=e.changedTouches[0].pageX}),m(b,"touchmove",function(e){D||(e.preventDefault?e.preventDefault():e.returnValue=!1,touch=e.touches[0]||e.changedTouches[0],touch.pageX-T>40?(D=!0,l()):touch.pageX-T<-40&&(D=!0,f()))}),m(b,"touchend",function(){D=!1}),m(document,"keydown",function(e){switch(e.keyCode){case 37:l();break;case 39:f();break;case 27:o()}})}function r(e){if(_!==e){for(_=e,i(B[e].options);w.firstChild;)w.removeChild(w.firstChild);j.length=0;for(var t,n=0;n<B[e].length;n++)t=y("div"),t.className="full-image",t.id="baguette-img-"+n,j.push(t),w.appendChild(j[n])}}function i(e){e||(e={});for(var t in A)L[t]=A[t],"undefined"!=typeof e[t]&&(L[t]=e[t]);w.style.transition=w.style.webkitTransition="fadeIn"===L.animation?"opacity .4s ease":"slideIn"===L.animation?"":"none","auto"===L.buttons&&("ontouchstart"in window||1===B[_].length)&&(L.buttons=!1),E.style.display=S.style.display=L.buttons?"":"none"}function s(e){"block"!==b.style.display&&(M=e,u(M,function(){d(M),v(M)}),c(),b.style.display="block",setTimeout(function(){b.className="visible"},50))}function o(){"none"!==b.style.display&&(b.className="",setTimeout(function(){b.style.display="none"},500))}function u(e,t){var n=j[e];if("undefined"!=typeof n){if(n.getElementsByTagName("img")[0])return void (t&&t());imageElement=B[_][e],imageCaption=imageElement.getAttribute("data-caption")||imageElement.title,imageSrc=a(imageElement);var r=y("figure"),i=y("img"),s=y("figcaption");n.appendChild(r),r.innerHTML='<div class="spinner"><div class="double-bounce1"></div><div class="double-bounce2"></div></div>',i.onload=function(){var n=document.querySelector("#baguette-img-"+e+" .spinner");r.removeChild(n),!L.async&&t&&t()},i.setAttribute("src",imageSrc),r.appendChild(i),L.captions&&imageCaption&&(s.innerHTML=imageCaption,r.appendChild(s)),L.async&&t&&t()}}function a(e){var t=imageElement.href;if(e.dataset){var n=[];for(var r in e.dataset)"at-"!==r.substring(0,3)||isNaN(r.substring(3))||(n[r.replace("at-","")]=e.dataset[r]);keys=Object.keys(n).sort(function(e,t){return parseInt(e)<parseInt(t)?-1:1});for(var i=window.innerWidth*window.devicePixelRatio,s=0;s<keys.length-1&&keys[s]<i;)s++;t=n[keys[s]]||t}return t}function f(){M<=j.length-2?(M++,c(),d(M)):L.animation&&(w.className="bounce-from-right",setTimeout(function(){w.className=""},400))}function l(){M>=1?(M--,c(),v(M)):L.animation&&(w.className="bounce-from-left",setTimeout(function(){w.className=""},400))}function c(){var e=100*-M+"%";"fadeIn"===L.animation?(w.style.opacity=0,setTimeout(function(){O.transforms?w.style.transform=w.style.webkitTransform="translate3d("+e+",0,0)":w.style.left=e,w.style.opacity=1},400)):O.transforms?w.style.transform=w.style.webkitTransform="translate3d("+e+",0,0)":w.style.left=e}function h(){var e=y("div");return"undefined"!=typeof e.style.perspective||"undefined"!=typeof e.style.webkitPerspective}function p(){var e=y("div");return e.innerHTML="<svg/>","http://www.w3.org/2000/svg"==(e.firstChild&&e.firstChild.namespaceURI)}function d(e){e-M>=L.preload||u(e+1,function(){d(e+1)})}function v(e){M-e>=L.preload||u(e-1,function(){v(e-1)})}function m(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)}function g(e){return document.getElementById(e)}function y(e){return document.createElement(e)}var b,w,E,S,x,T,N='<svg width="44" height="60"><polyline points="30 10 10 30 30 50" stroke="rgba(255,255,255,0.5)" stroke-width="4"stroke-linecap="butt" fill="none" stroke-linejoin="round"/></svg>',C='<svg width="44" height="60"><polyline points="14 10 34 30 14 50" stroke="rgba(255,255,255,0.5)" stroke-width="4"stroke-linecap="butt" fill="none" stroke-linejoin="round"/></svg>',k='<svg width="30" height="30"><g stroke="rgb(160, 160, 160)" stroke-width="4"><line x1="5" y1="5" x2="25" y2="25"/><line x1="5" y1="25" x2="25" y2="5"/></g></svg>',L={},A={captions:!0,buttons:"auto",async:!1,preload:2,animation:"slideIn"},O={},M=0,_=-1,D=!1,P=/.+\.(gif|jpe?g|png|webp)/i,H=[],B=[],j=[];return[].forEach||(Array.prototype.forEach=function(e,t){for(var n=0;n<this.length;n++)e.call(t,this[n],n,this)}),[].filter||(Array.prototype.filter=function(e,t,n,r,i){for(n=this,r=[],i=0;i<n.length;i++)e.call(t,n[i],i,n)&&r.push(n[i]);return r}),{run:e}}();define("baguettebox",function(){}),require.config({paths:{jquery:"libs/jquery-1.8.3.min",config:"comm/config",base:"comm/base",ajax:"comm/ajax",up:"comm/uploadUtils",pjax:"comm/pjax",mas:"comm/masonry",share:"comm/shareViewcomm",swiper:"libs/swiper.min",jquery_ui:"jqui/jquery-ui.min",infinitescroll:"plugin/jquery.infinitescroll.min",lazyload:"plugin/jquery.lazyload.min",jquerypjax:"plugin/jquery.pjax",baguettebox:"plugin/baguettebox.min",checkInput:"plugin/checkInput.min",checkImgExists:"plugin/checkImgExists",checkboxFn:"plugin/checkboxFn.min",serializeJson:"plugin/serializeJson.min",setTagPos:"plugin/setTagPos.min",stopscroll:"plugin/stopscroll.min",plus:"plugin/plus.min",countdown:"plugin/countdown.min",scrollToEnd:"plugin/scroll.min",fixedTop:"plugin/fixedTop.min",hoverclick:"plugin/hoverclick.min",jcrop:"jcrop/jquery.Jcrop.min"}}),require(["jquery","ajax","base","mas","baguettebox"],function(e,t,n,r){var i=function(){n.init(),baguetteBox.run(".pl_cont_img"),r.masonryInit({masonry:"masonry",issearch:!1,islazy:1,callback:function(){}})};return i()}),define("evaluate",function(){});
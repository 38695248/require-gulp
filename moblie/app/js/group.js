require.config({paths:{jquery:"libs/jquery-1.8.3.min",config:"comm/config",base:"comm/base",ajax:"comm/ajax",up:"comm/uploadUtils",pjax:"comm/pjax",mas:"comm/masonry",share:"comm/shareViewcomm",swiper:"libs/swiper.min",jquery_ui:"jqui/jquery-ui.min",infinitescroll:"plugin/jquery.infinitescroll.min",lazyload:"plugin/jquery.lazyload.min",jquerypjax:"plugin/jquery.pjax",baguettebox:"plugin/baguettebox.min",checkInput:"plugin/checkInput.min",checkImgExists:"plugin/checkImgExists",checkboxFn:"plugin/checkboxFn.min",serializeJson:"plugin/serializeJson.min",setTagPos:"plugin/setTagPos.min",stopscroll:"plugin/stopscroll.min",plus:"plugin/plus.min",countdown:"plugin/countdown.min",scrollToEnd:"plugin/scroll.min",fixedTop:"plugin/fixedTop.min",hoverclick:"plugin/hoverclick.min",jcrop:"jcrop/jquery.Jcrop.min"}}),define(["jquery","config","base","ajax","mas","swiper"],function(e,t,n,r,i){var s=function(){},o=function(n){if(n.catid_area){var i="";n.catid_type==1?i+="明星,":n.catid_type==2?i+="街拍达人,":i+="模特,",e("#user_group_area").find(".li_click").each(function(t,r){if(t+1==n.catid_area){var s=e(this).text();i+=s}}),n.catid_sex==1?i+=",男":i+=",女",e("#select_cat_text").html(i)}e("#group_cat").unbind("click").bind("click",function(n){function i(){var t=!1,n=!1,r=!1;e("#catlist_type").find("li").each(function(n,r){var i=e(this).hasClass("current");i&&(t=!0)}),e("#catlist_sex").find("li").each(function(t,r){var i=e(this).hasClass("current");i&&(n=!0)}),e("#catlist_area").find("li").each(function(t,n){var i=e(this).hasClass("current");if(i){var s=e(this).attr("value");r=!0}}),t&&r&&n?(e("#sns_grouptype").find(".btn-danger").addClass("btnTipsubmit").removeClass("btn-danger-gray"),e("#sns_grouptype").find(".btnTipsubmit").unbind("click").bind("click",function(){s()})):e("#sns_grouptype").find(".btn-danger").removeClass("btnTipsubmit").addClass("btn-danger-gray")}function s(){var n="";e("#catlist_type").find("li").each(function(t,r){var i=e(this).hasClass("current");if(i){var s=e(this).attr("value");n+=e(this).text()+",",e("#select_cat_type").val(s)}}),e("#catlist_area").find("li").each(function(t,r){var i=e(this).hasClass("current");if(i){var s=e(this).attr("value");n+=e(this).text()+",",e("#select_cat_area").val(s)}}),e("#catlist_sex").find("li").each(function(t,r){var i=e(this).hasClass("current");if(i){var s=e(this).attr("value");n+=e(this).text(),e("#select_cat_sex").val(s)}}),e("#select_cat_text").text(n),t.closeTip(e("#sns_grouptype"))}r.ajaxInit({url:"/common/gettpl.html?name=sns_grouptype&ch=sns",isloading:!0,yzlogin:!0,type:"GET",dataType:"html",params:{},callback:function(n){e("body").append(n);var r=e("#user_group_area").html();e("#catlist_area").html(r),t.tip.centerDiv({divId:"sns_grouptype",type:1,callback:function(){var t=e("#select_cat_type").val(),n=e("#select_cat_area").val(),r=e("#select_cat_sex").val();i(),e("#catlist_type").find(".li_click").each(function(n,r){var s=e(this).attr("value");s==t&&(e(this).addClass("current"),i())}),e("#catlist_area").find(".li_click").each(function(t,r){var s=e(this).attr("value");s==n&&(e(this).addClass("current"),i())}),e("#catlist_sex").find(".li_click").each(function(t,n){var s=e(this).attr("value");s==r&&(e(this).addClass("current"),i())}),e(".catlist").find(".li_click").unbind("click").bind("click",function(){e(this).addClass("current"),e(this).siblings(".li_click").removeClass("current"),i()})}})}})})},u=function(){r.ajaxInit({url:"/user_group/add_pin_groups.html	",params:{ajax:1},callback:function(t){if(t.status==1){if(!t.data)return e("#groupList").hide(),!1;var n='<input name="gpid" id="gpid" value="" type="hidden">';e.each(t.data,function(e,t){var r='<li style="padding-right:20px" class="rowbox li_radio_p"><span class="ico groupavatar"><img src="'+t.avatar[2]+'" data-original="'+t.avatar[1]+'" class="lazy_groupavatar"></span><div class="row-flex1 line40"><label for="'+t.gpid+'" class="row-flex1 label li_radio" style="line-height:60px;background-position: right 18px;" data-gpid="'+t.gpid+'">'+t.gpname+"</label></div></li>";n+=r}),e("#group_cat_share").find(".group_categoryList").html(n),e("img.lazy_groupavatar").checkImgExists(),e(".li_radio").unbind("click").bind("click",function(){var t=e(this).hasClass("current"),n=e(this).attr("data-gpid");t?(e(this).removeClass("current"),e("#gpid").val("")):(e("#gpid").val(n),e(this).addClass("current"),e(this).parents(".li_radio_p").siblings(".li_radio_p").find(".li_radio").removeClass("current"))})}e("#group_cat_share").selectUtils({deNum:0,isDef:!0,callback:function(t,n){var r=e("#group_cat").find("input");checkInputFun.initContext(r,checkInputFun.myIt),r.siblings("p").show(),checkInputFun.mycheckIn(r),e("#group_cat").siblings(".select_box").find("span").html("选择分类").removeClass("active"),e("#group_cat").siblings(".select_box").find(".select_analog ").val("")}})}})},a=function(t){var n={gpid:"",pic_avatar:"",pic_qrcode:"",pic_figure:"",btn:"",avatartype:"",auto_start:!1,callback:null};t&&e.extend(!0,n,t),BaseInitClass.loginCheck(),n.btn.unbind("click").bind("click",function(){var i=e(this),s=e(this).attr("data-name"),o=e(this).attr("data-avatar"),u=i.attr("data-type"),a=i.attr("data-act"),f=n.pic_avatar,l=i.attr("data-title"),c=i.siblings(".uppro_pic_list"),h=!1,p=1;u==3&&(h=!0,p=3),u=="qrcode"&&(f=n.pic_qrcode),u=="figure"&&(f=n.pic_figure),o&&(f=o),UploadUtils.uploadInit({tip:!0,uptitle:l,container:"allcontainer",browse_button:"allpickfiles",drop_element:"allcontainer",bucket:"avatar",iscover:!0,auto_start:n.auto_start,multi_selection:!1,picname:f,typebucket:2,callback:function(e,s){r.ajaxInit({url:"/common/avatar_up_cmm_back.html",params:{act:a,type:u,gpid:n.gpid,ch:"up",cutsize:""},callback:function(r){var o={arrData:e,odomain:s,resin:r,btn:i};t.callback&&n.callback(o)}})}})})},f=function(){e(".creatGroupBtn").unbind("click").bind("click",function(n){var i=BaseInitClass.loginCheck();if(!i)return!1;n.stopPropagation(),r.ajaxInit({url:"/user_group/add.html",type:"post",yzlogin:!0,params:{ajax:1},callback:function(n){if(n.status==1){var r=e('<div id="creatGroupTipbox" class="tipbox fade" data-index="0" style="display:none;"><div class="tipbox-in"><h1 class="tiptop">绑定微信群</h1><span class="ico02 tipclose closeBtnHtml"></span><div class="tipcont" id="creatGroupCont"></div>');e("body").append(r),e("#creatGroupCont").html(e(n.data).find(".contentbox").html()),t.tip.centerDiv({divId:"creatGroupTipbox",callback:function(){l({type:"share"})}})}else t.tip.tips({htmlmsg:'<div style="padding:30px">'+n.msg+"</div>",type:0})}})})},l=function(n){function s(){var t=!1;return e(".uppro_pic").each(function(n,r){return e(this).checkboxFn({checkbox:"hidden",scallback:function(e){e.removeClass("error_validate"),t=!0},errorcallback:function(e){e.addClass("error_validate"),t=!1}}),t}),t}function u(t){function r(t){var r=e(".up_rzpic");t&&(r=t),a({gpid:n.gpid,pic_avatar:n.pic_avatar,pic_qrcode:n.pic_qrcode,pic_figure:n.pic_figure,btn:r,callback:function(e){var t='<li class="li_del"><input type="hidden" class="hideimageurl" name="'+e.inputName+'" value="/'+e.arrData.key+'"><img src="'+e.resin.data+'" /><div class="operate"><i class="ico del"></i></div></li>';e.imgbox.find("ul").append(t),i(e.imgbox,e.btn,e.type),u(e.imgbox,e.btn,e.type),o(e.imgbox,e.btn,e.type)}})}function i(t,n,r){t.show(),t.find("li").hover(function(){e(this).find(".operate").show()},function(){e(this).find(".operate").hide()})}function o(t,n,r){t.find(".del").unbind("click").bind("click",function(){e(this).parents("li.li_del").remove();var i=t.find("li").size();i<=0&&t.hide(),u(t,n,r)})}function u(e,t,n){s(e,t,n);var i=e.find("li").size(),o=1;n==3&&(o=3);var u=!0;return i>=o?(t.addClass("btn-danger-gray"),t.unbind("click"),u=!1,u):(t.removeClass("btn-danger-gray"),r(t),o-=i,u)}var n={picname:""};t&&e.extend(!0,n,t),r()}var i={type:""};n&&e.extend(!0,i,n),o({}),e("#creatGroupForm").checkInput({submitBtnFn:function(n){var s=n.serializeJson(),o=e("#creatGroupForm").attr("data-action");r.ajaxInit({url:o,params:s,callback:function(n){n.status==1?(window.location.href="/user_group/home.html?gpid="+n.data.gpid+"&ukey="+ukey,e("#creatbtn_wc").unbind("click").bind("click",function(){i.type=="share"?t.closeTip(e("#creatGroupTipbox")):window.location.href="/user_group/my.html"})):t.tip.tips({htmlmsg:'<div style="padding:30px">'+n.msg+"</div>",w:"90%",type:0})}})}})};return{creatWeixinGroup_share:f,addgrouppage:l,getGroupList:u,selectCat:o,upGroupAvatar:a}});
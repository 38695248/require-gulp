;(function (factory) {
    if (typeof define === "function" && define.amd) {
        // AMD模式
        define([ "jquery" ], factory);
    } else {
        // 全局模式
        factory(jQuery);
    }
}(function ($) {
	$.fn.fixedTop = function(options){
		var $this = this;
		var settings = {
			isdiv:false,
			showDiv:"",
			topHeight:20,
			maxHeight:999999,
			scallback:function(){},
			ecallback:function(){}
		};
		if(options){
			$.extend(settings,options);
		};
		
		if(options.showDiv){
			var $thisDiv = settings.showDiv;
			settings.maxHeight = $thisDiv.height();
		}
		var fixedTop = function(){
			
			if(settings.isdiv){
				nvnexttop = $this.offset().top-document.body.scrollTop;
				var dofixed = nvnexttop <= settings.topHeight;
			}else{
				var nvnexttop = document.body.scrollTop-settings.topHeight || document.documentElement.scrollTop-settings.topHeight;	
				var dofixed = nvnexttop >= settings.topHeight && nvnexttop <= settings.maxHeight;
			}
			
			if(dofixed){
				//$("#" + settings.showDiv).show();
				//$this.addClass("shadow");
				if(options.scallback){
					settings.scallback($this);	
				}
			}else{
				if(options.ecallback){
					settings.ecallback($this);	
				}
				//$("#" + settings.showDiv).hide();
				//$this.removeClass("shadow");	
			};
		};
		var attachEvent = function(obj, evt, func, eventobj) {
			eventobj = !eventobj ? obj : eventobj;
			if(obj.addEventListener) {
				obj.addEventListener(evt, func, false);
			} else if(eventobj.attachEvent) {
				obj.attachEvent('on' + evt, func);
			}
		};
		attachEvent(window, 'scroll', fixedTop);
	};
}));